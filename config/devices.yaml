# devices.yaml
# AWE Test Rig Hardware Configuration
# 
# This file contains all hardware-specific settings including:
# - NI cDAQ channel mappings and calibration
# - Serial port configurations  
# - Device communication settings
# - CALIBRATED ZERO OFFSETS for pressure/current sensors

# [2025-08-01 11:53:27] SUCCESS  [Libraries]    - NI-DAQmx library loaded
# ‚úÖ Pico TC-08 libraries available
# [2025-08-01 11:53:28] SUCCESS  [System]       - Window icon loaded: C:\Users\terra\Desktop\test_rig\assets\favicon.ico
# [2025-08-01 11:53:28] SUCCESS  [System]       - Dashboard window maximized
# [2025-08-01 11:53:28] INFO     [SessionMgr]   - Initializing session directory
#     ‚Üí Base: C:\Users\terra\Desktop\test_rig\data
#     ‚Üí Sessions: C:\Users\terra\Desktop\test_rig\data\sessions
# [2025-08-01 11:53:28] SUCCESS  [SessionMgr]   - Directory structure ready
# [2025-08-01 11:53:28] INFO     [ConfigLoader] - Loading config: devices.yaml
# [2025-08-01 11:53:28] SUCCESS  [ConfigLoader] - Loaded 24 devices from config
#     ‚Üí Calibration date: 2025-06-04
# [2025-08-01 11:53:28] INFO     [ConfigLoader] - BGA analyzers configured
#     ‚Ä¢ bga_1 (COM8): H2/O2
#     ‚Ä¢ bga_2 (COM3): O2/H2
#     ‚Ä¢ bga_3 (COM9): O2/H2
# üîå Connect button clicked
# [2025-08-01 11:53:54] INFO     [System]       - Starting all hardware services
#    ‚Üí Starting NI cDAQ service...
# [2025-08-01 11:53:54] INFO     [DAQ]          - Connecting to NI cDAQ...
#    ‚Üí Setting all outputs to safe state (OFF)
# [2025-08-01 11:53:56] SUCCESS  [DAQ]          - NI cDAQ connected and polling at 100 Hz
#     ‚Ä¢ Found: cDAQ9187-23E902C
#     ‚Üí 8 analog channels configured
#     ‚Ä¢ PT01: cDAQ9187-23E902CMod1/ai0 (4-20mA, calibrated 4.0-20.0mA)
#     ‚Ä¢ PT02: cDAQ9187-23E902CMod1/ai1 (4-20mA, calibrated 4.0-20.0mA)
#     ‚Ä¢ Current: cDAQ9187-23E902CMod1/ai2 (4-20mA, calibrated 4.0-20.0mA)
#     ‚Ä¢ PT03: cDAQ9187-23E902CMod1/ai3 (4-20mA, calibrated 4.0-20.0mA)
#     ‚Ä¢ PT04: cDAQ9187-23E902CMod1/ai4 (4-20mA, calibrated 4.0-20.0mA)
#     ‚Ä¢ PT05: cDAQ9187-23E902CMod1/ai5 (4-20mA, calibrated 4.0-20.0mA)
#     ‚Ä¢ Flowrate: cDAQ9187-23E902CMod1/ai6 (4-20mA, calibrated 4.0-20.0mA)
#     ‚Ä¢ PT06: cDAQ9187-23E902CMod1/ai7 (4-20mA, calibrated 4.0-20.0mA)
#     ‚Üí 7 digital outputs configured
#     ‚Ä¢ KOH Storage: cDAQ9187-23E902CMod2/port0/line0
#     ‚Ä¢ DI Storage: cDAQ9187-23E902CMod2/port0/line1
#     ‚Ä¢ Stack Drain: cDAQ9187-23E902CMod2/port0/line2
#     ‚Ä¢ N2 Purge: cDAQ9187-23E902CMod2/port0/line3
#     ‚Ä¢ O2 Purge: cDAQ9187-23E902CMod2/port0/line5
#     ‚Ä¢ Pump: cDAQ9187-23E902CMod2/port0/line4
#     ‚Ä¢ KOH Pump: cDAQ9187-23E902CMod2/port0/line6
# [2025-08-01 11:53:56] SUCCESS  [DAQ]          - NI DAQ polling started at 100 Hz
#    ‚úÖ NI cDAQ connected - Pressure/Current sensors + Valve/Pump control
#    ‚Üí Starting Pico TC-08 service...
# üå°Ô∏è  Connecting to Pico TC-08 thermocouple logger...
#    ‚Üí Loading TC-08 DLL...
#    ‚Üí TC-08 library loaded: C:\Program Files\Pico Technology\SDK\lib\usbtc08.dll
#    ‚Üí DLL loaded successfully
#    ‚Üí Connecting to hardware...
#    ‚Üí TC-08 device opened with handle: 1
#    ‚Üí Hardware connected (handle: 1)
#    ‚Üí Configuring channels...
#    ‚Üí Configured 8 K-type thermocouple channels
#    ‚Üí Configured 8 thermocouple channels:
#      ‚Ä¢ CH0: TC01
#      ‚Ä¢ CH1: TC02
#      ‚Ä¢ CH2: TC03
#      ‚Ä¢ CH3: TC04
#      ‚Ä¢ CH4: TC05
#      ‚Ä¢ CH5: TC06
#      ‚Ä¢ CH6: TC07
#      ‚Ä¢ CH7: TC08
# ‚úÖ Pico TC-08 connected successfully
# üå°Ô∏è  Starting Pico TC-08 polling at 1 Hz...
#    ‚Üí TC-08 streaming started at 1Hz
# ‚úÖ Pico TC-08 polling started
#    ‚úÖ Pico TC-08 connected - 8-channel thermocouple logger
#    ‚Üí Starting BGA244 analyzers...
#    ‚Üí Connecting BGAs to configured ports...
#    ‚Üí Trying to connect BGA01 to COM8...
# üîå Connecting to BGA01 on COM8...
# ‚ùå No response from device on COM8
# ‚úÖ Disconnected from COM8
#    ‚ùå BGA01 failed to connect to COM8
#    ‚Üí Trying to connect BGA02 to COM3...
# üîå Connecting to BGA02 on COM3...
# ‚ùå No response from device on COM3
# ‚úÖ Disconnected from COM3
#    ‚ùå BGA02 failed to connect to COM3
#    ‚Üí Trying to connect BGA03 to COM9...
# üîå Connecting to BGA03 on COM9...
# ‚ùå Connection failed on COM9: could not open port 'COM9': FileNotFoundError(2, 'The system cannot find the file specified.', None, 2)
#    ‚ùå BGA03 failed to connect to COM9
# [2025-08-01 11:53:58] WARNING  [BGA244]       - No BGA244 hardware detected
#     ‚Üí All BGAs will show no data until connected
# [2025-08-01 11:53:58] SUCCESS  [BGA244]       - BGA244 polling started at 0.2 Hz
#    ‚úÖ BGA244 connected - 3x gas analyzers (H2, O2, N2)
#    ‚Üí Starting CVM-24P service...
#    ‚Üí Loaded 5 module mappings from devices.yaml
#    ‚Üí Physical connection order:
#       Module 1 - 158458 (0xA1)
#       Module 2 - 158436 (0xA6)
#       Module 3 - 158435 (0xA7)
#       Module 4 - 158453 (0xA4)
#       Module 5 - 158340 (0xA9)
# [2025-08-01 11:53:58] INFO     [CVM24P]       - Connecting 5 CVM modules on serial port
#    ‚Üí Found 1 available ports: ['COM5']
#    ‚Üí Trying port COM5 (1/1)...
# DEBUG: ===== Starting CVM24P connection debug session =====
#    ‚Üí Connecting to COM5 at 1000000 baud...
#       ‚Üí Bus connected
#       ‚Üí Using ultra-fast initialization with cached addresses...
#       ‚Üí ‚úÖ Created module map for 5 cached modules - proceeding to initialization
#    ‚Üí Initializing 5 modules...
#    ‚Üí DEBUG: Initialization order: ['158458', '158436', '158435', '158453', '158340']
#    ‚úÖ Module 158458 (0xA1) initialized
#    ‚úÖ Module 158436 (0xA6) initialized
#    ‚úÖ Module 158435 (0xA7) initialized
#    ‚úÖ Module 158453 (0xA4) initialized
#    ‚úÖ Module 158340 (0xA9) initialized
#    ‚Üí DEBUG: Successfully initialized modules: ['158458', '158436', '158435', '158453', '158340']
#    ‚Üí Success! 5/5 modules initialized via ultra-fast cached path (100.0% success rate)
# DEBUG: Voltage reading - module sorting and channel assignment (PHYSICAL ORDER):
#    ‚Üí Success on COM5!
# DEBUG:   Module 158458 (0xA1) ‚Üí Channels 1-24
# DEBUG:   Module 158436 (0xA6) ‚Üí Channels 25-48
# DEBUG:   Module 158435 (0xA7) ‚Üí Channels 49-72
# DEBUG:   Module 158453 (0xA4) ‚Üí Channels 73-96
# DEBUG:   Module 158340 (0xA9) ‚Üí Channels 97-120
# [2025-08-01 11:54:08] SUCCESS  [CVM24P]       - All 5 modules initialized
# [2025-08-01 11:54:08] SUCCESS  [CVM24P]       - Polling started at 10 Hz
#    ‚úÖ CVM-24P connected - 24-channel cell voltage monitor
# [2025-08-01 11:54:08] SUCCESS  [System]       - All 4 services started successfully
#    ‚úÖ All devices connected via ControllerManager
# ‚ñ∂Ô∏è  Start Test button clicked
#    ‚Üí Starting test sequence...
#    ‚Üí Plots reset for new test
# [2025-08-01 11:54:15] INFO     [SessionMgr]   - Starting test session: 2025-08-01_11-54-15_UI_Test_Session
#     ‚Üí Session path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session
#     ‚Üí Start time: 2025-08-01 11:54:15
#    ‚Üí Configuration snapshot saved
#       ‚Üí Getting base filename from session manager...
#       ‚Üí Base filename: 2025-08-01_11-54-15
#       ‚Üí Creating 4 CSV files...
#          ‚Ä¢ Creating main_sensors: 2025-08-01_11-54-15_sensors.csv
#            ‚Üí Full path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\csv_data\2025-08-01_11-54-15_sensors.csv
#            ‚Üí Opening file for writing...
#            ‚Üí Writing 18 column headers
#            ‚Üí ‚úÖ main_sensors file created successfully
#          ‚Ä¢ Creating gas_analysis: 2025-08-01_11-54-15_gas_analysis.csv
#            ‚Üí Full path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\csv_data\2025-08-01_11-54-15_gas_analysis.csv
#            ‚Üí Opening file for writing...
#            ‚Üí Writing 9 column headers
#            ‚Üí ‚úÖ gas_analysis file created successfully
#          ‚Ä¢ Creating cell_voltages: 2025-08-01_11-54-15_cell_voltages.csv
#            ‚Üí Full path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\csv_data\2025-08-01_11-54-15_cell_voltages.csv
#            ‚Üí Opening file for writing...
#            ‚Üí Writing 122 column headers
#            ‚Üí ‚úÖ cell_voltages file created successfully
#          ‚Ä¢ Creating actuator_states: 2025-08-01_11-54-15_actuators.csv
#            ‚Üí Full path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\csv_data\2025-08-01_11-54-15_actuators.csv
#            ‚Üí Opening file for writing...
#            ‚Üí Writing 9 column headers
#            ‚Üí ‚úÖ actuator_states file created successfully
#       ‚Üí ‚úÖ All 4 CSV files initialized
# üìä CSV logging worker started (interval: 1.0s)
# [2025-08-01 11:54:15] SUCCESS  [DataLogger]   - CSV logging started successfully
#     ‚Üí Log interval: 1.0s
#     ‚Üí Files created: 4
#     ‚Ä¢ main_sensors: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\csv_data\2025-08-01_11-54-15_sensors.csv
#     ‚Ä¢ gas_analysis: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\csv_data\2025-08-01_11-54-15_gas_analysis.csv
#     ‚Ä¢ cell_voltages: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\csv_data\2025-08-01_11-54-15_cell_voltages.csv
#     ‚Ä¢ actuator_states: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\csv_data\2025-08-01_11-54-15_actuators.csv
# [2025-08-01 11:54:15] SUCCESS  [TestRunner]   - Starting test session
#     ‚Üí Session name: 2025-08-01_11-54-15_UI_Test_Session
#     ‚Üí Configuration saved: 2025-08-01_11-54-15.json
#     ‚Üí Timer: Started
#     ‚Üí CSV logging: 4 files created (1.0s interval)
#    ‚úÖ Test started successfully with CSV data logging
#    ‚Üí CSV files are being created in session folder
# ‚èπÔ∏è  Stop Test button clicked
#    ‚Üí Stopping test sequence...
# üìä CSV logging worker stopped
# [2025-08-01 11:55:10] SUCCESS  [DataLogger]   - CSV logging stopped
#     ‚Üí Log entries: 55
#     ‚Üí Duration: 00:54
# üìÅ Active channels saved to session metadata:
#    ‚Üí pressure: [0, 1, 2, 3, 4]
#    ‚Üí gas: [0, 1, 2]
#    ‚Üí temperature: [0, 1, 2, 3, 4, 5, 6, 7]
#    ‚Üí current: [0]
# [2025-08-01 11:55:10] INFO     [SessionMgr]   - Session ended: 2025-08-01_11-54-15_UI_Test_Session
#     ‚Üí Duration: 0:00:54
#     ‚Üí Status: completed
#     ‚Üí Files created: 5
# [2025-08-01 11:55:11] INFO     [PostProcessor] - Generating plots for session: 2025-08-01_11-54-15_UI_Test_Session
# üìä Loading CSV data from C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\csv_data
#    ‚Üí Loading sensors: 2025-08-01_11-54-15_sensors.csv
#    ‚úÖ Loaded 55 rows from sensors
#    ‚Üí Loading gas_analysis: 2025-08-01_11-54-15_gas_analysis.csv
#    ‚úÖ Loaded 55 rows from gas_analysis
#    ‚Üí Loading cell_voltages: 2025-08-01_11-54-15_cell_voltages.csv
#    ‚úÖ Loaded 55 rows from cell_voltages
#    ‚Üí Loading actuators: 2025-08-01_11-54-15_actuators.csv
#    ‚úÖ Loaded 55 rows from actuators
# ‚úÖ Data loaded successfully, max time: 54.4s
# üìä Generating pressure plot...
# ‚úÖ Pressure plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\plots\pressure.jpg
# üìä Generating gas purity plot...
# ‚úÖ Gas purity plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\plots\gas_purity.jpg
# üìä Generating temperature plot...
# ‚úÖ Temperature plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\plots\temperature.jpg
# üìä Generating cell voltage plot...
# C:\Users\terra\Desktop\test_rig\data\post_processor.py:364: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
#   ax.legend()
# ‚úÖ Cell voltage plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\plots\cell_voltage.jpg
# üìä Generating current plot...
# ‚úÖ Current plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\plots\current.jpg
# üìä Generating flowrate plot...
# ‚úÖ Flowrate plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-08-01_11-54-15_UI_Test_Session\plots\flowrate.jpg
# [2025-08-01 11:55:12] ERROR    [PostProcessor] - Post-processing error: 'DataPostProcessor' object has no attribute 'data_files'
#     ‚Üí Test session saved successfully, but plots not generated
# [2025-08-01 11:55:12] INFO     [TestRunner]   - Stopping test session
#     ‚Üí Duration: 0:00:54
#     ‚Üí Files created: 5
#     ‚Üí Entries logged: 55
#    ‚úÖ Test stopped - CSV data logging completed
#    ‚Üí 5 files saved in session folder
# üîå Disconnect button clicked
#    ‚Üí Stopping NI cDAQ service...
# [2025-08-01 11:55:14] SUCCESS  [DAQ]          - NI DAQ polling stopped
# [2025-08-01 11:55:14] WARNING  [DAQ]          - NI DAQ polling already stopped
#    ‚Üí Setting all outputs to safe state (OFF)
# [2025-08-01 11:55:15] SUCCESS  [DAQ]          - NI cDAQ disconnected
#    ‚úÖ NI cDAQ disconnected
#    ‚Üí Stopping Pico TC-08 service...
# üå°Ô∏è  Stopping Pico TC-08 polling...
# ‚úÖ Pico TC-08 polling stopped
# üå°Ô∏è  Disconnecting from Pico TC-08...
#    ‚Üí TC-08 device closed
# ‚úÖ Pico TC-08 disconnected
#    ‚úÖ Pico TC-08 disconnected
#    ‚Üí Stopping BGA244 analyzers...
# [2025-08-01 11:55:15] SUCCESS  [BGA244]       - BGA244 polling stopped
# ‚öóÔ∏è  Disconnecting from BGA244 analyzers...
# ‚úÖ BGA244 analyzers disconnected (port mappings preserved for reconnection)
#    ‚úÖ BGA244 disconnected
#    ‚Üí Stopping CVM-24P service...
# [2025-08-01 11:55:15] INFO     [CVM24P]       - Polling stopped
# [2025-08-01 11:55:15] SUCCESS  [CVM24P]       - Disconnected
#    ‚úÖ CVM-24P disconnected
# [2025-08-01 11:55:15] SUCCESS  [System]       - All services stopped
#    ‚úÖ All devices disconnected via ControllerManager

# NI cDAQ Configuration
ni_cdaq:
  chassis: "cDAQ9187-23E902C"
  
  # NI-9253 Analog Input Module (4-20mA Current Inputs)
  analog_inputs:
    module: "cDAQ9187-23E902CMod1"
    sample_rate: 100  # Hz
    
    # 4-20mA Signal Conditioning
    current_range:
      min_ma: 4.0   # Calibrated minimum - 4mA = 0 PSI/A (updated from 3.95)
      max_ma: 20.0  # Standard maximum
      fault_threshold_low: 3.5   # Below this = DISCONNECTED
      fault_threshold_high: 20.5 # Above this = OVERRANGE
    
    # Individual Sensor Channels with Calibrated Zero Offsets
    channels:
      pt01:
        channel: "ai0"
        name: "PT01"
        units: "PSI"
        range: [0, 15]
        # CALIBRATED ZERO OFFSET - Corrects sensor bias at 0 PSI
        zero_offset: -0.035  # Corrects +0.035 PSI bias to achieve true 0 PSI
        description: "Hydrogen side pressure measurement"
        
      pt02:
        channel: "ai1" 
        name: "PT02"
        units: "PSI"
        range: [0, 15]
        # CALIBRATED ZERO OFFSET - Corrects sensor bias at 0 PSI  
        zero_offset: -0.066  # Corrects +0.066 PSI bias to achieve true 0 PSI
        description: "Oxygen side pressure measurement"
        
      current:
        channel: "ai2"
        name: "Current"
        units: "A"
        range: [0, 150]
        # CALIBRATED ZERO OFFSET - 4mA represents true 0 A
        zero_offset: 0.0  # No bias correction needed for current sensor
        description: "Electrolyzer stack current measurement"
        
      pt03:
        channel: "ai3"
        name: "PT03"
        units: "PSI"
        range: [0, 1.012]  # 0-28 inWC converted to PSI (28 * 0.036127 = 1.012)
        zero_offset: 0.0
        description: "Pressure transducer 01 (4-20mA)"
        
      pt04:
        channel: "ai4"
        name: "PT04"  
        units: "PSI"
        range: [0, 1.012]  # 0-28 inWC converted to PSI
        zero_offset: 0.0
        description: "Pressure transducer 02 (4-20mA)"
        
      pt05:
        channel: "ai5"
        name: "PT05"
        units: "PSI"
        range: [0, 1.012]  # 0-28 inWC converted to PSI
        zero_offset: 0.0
        description: "Pressure transducer 03 (4-20mA)"
        
      flowrate:
        channel: "ai6"
        name: "Flowrate"
        units: "SLM"
        range: [0, 250]  # 0-250 SLM (Standard Liters per Minute)
        zero_offset: 0.0
        description: "Gas flowrate measurement"
        
      pt06:
        channel: "ai7"
        name: "PT06"
        units: "PSI"
        range: [0, 1.012]  # 0-28 inWC converted to PSI
        zero_offset: 0.0
        description: "Pressure transducer 05 (4-20mA)"
  
  # NI-9485 Digital Output Modules (Relay Control)
  digital_outputs:
    module_2: "cDAQ9187-23E902CMod2"
    module_3: "cDAQ9187-23E902CMod3"
    
    # Valve and Pump Control Mapping
    valves:
      koh_storage:
        module: "cDAQ9187-23E902CMod2"
        line: 0
        name: "KOH Storage Valve"
        description: "Controls KOH electrolyte storage tank valve"
        
      di_storage:
        module: "cDAQ9187-23E902CMod2"
        line: 1
        name: "DI Storage Valve"
        description: "Controls deionized water storage tank valve"
        
      stack_drain:
        module: "cDAQ9187-23E902CMod2" 
        line: 2
        name: "Stack Drain Valve"
        description: "Controls electrolyzer stack drain valve"
        
      h2_purge:
        module: "cDAQ9187-23E902CMod2"
        line: 3
        name: "H2 Purge Valve"
        description: "Controls hydrogen purge valve for system cleanup"
        
      o2_purge:
        module: "cDAQ9187-23E902CMod2"
        line: 5
        name: "O2 Purge Valve"
        description: "Controls oxygen purge valve for system cleanup"
        
    pump:
      di_fill_pump:
        module: "cDAQ9187-23E902CMod2"
        line: 4
        name: "DI Fill Pump"
        description: "Controls deionized water fill pump"
        
      koh_fill_pump:
        module: "cDAQ9187-23E902CMod2"
        line: 6
        name: "KOH Fill Pump"
        description: "Controls KOH electrolyte fill pump"

# Pico TC-08 Thermocouple Logger
pico_tc08:
  device_type: "Pico TC-08"
  connection: "USB"
  
  # Temperature Channels - NO ZERO OFFSETS (raw thermocouple readings)
  channels:
    channel_0:
      name: "TC01"
      type: "K"  # Thermocouple type
      units: "¬∞C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 1 temperature sensor"
      
    channel_1:
      name: "TC02"
      type: "K"
      units: "¬∞C" 
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 2 temperature sensor"
      
    channel_2:
      name: "TC03"
      type: "K"
      units: "¬∞C"
      range: [0, 100] 
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 3 temperature sensor"
      
    channel_3:
      name: "TC04"
      type: "K"
      units: "¬∞C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 4 temperature sensor"
      
    channel_4:
      name: "TC05"
      type: "K"
      units: "¬∞C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 5 temperature sensor"
      
    channel_5:
      name: "TC06"
      type: "K"
      units: "¬∞C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 6 temperature sensor"
      
    channel_6:
      name: "TC07"
      type: "K"
      units: "¬∞C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 7 temperature sensor"
      
    channel_7:
      name: "TC08"
      type: "K"
      units: "¬∞C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 8 temperature sensor"

# BGA244 Gas Analyzers (3 units)
bga244:
  communication:
    protocol: "RS-422"
    interface: "USB-to-RS422"
    baud_rate: 9600
    data_bits: 8
    stop_bits: 1
    parity: "None"
    timeout: 2.0  # seconds
  
  # Three BGA244 Units (Windows COM ports)
  units:
    bga_1:
      port: "COM8"
      name: "BGA01"
      gas_types: ["H2", "O2", "N2"]
      description: "Gas analyzer on hydrogen header"
      # Gas analysis configuration for normal operation
      normal_mode:
        primary_gas: "H2"     # H2 in O2 mixture
        secondary_gas: "O2"   # H2 in O2 mixture
        remaining_gas: "N2"   # Remaining gas (calculated)
        expected_gases: ["H2", "O2", "N2"]
      # Gas analysis configuration for purge operation
      purge_mode:
        primary_gas: "H2"     # H2 in N2 during purge
        secondary_gas: "N2"   # N2 purge gas
        remaining_gas: "O2"   # Remaining gas (calculated)
        expected_gases: ["H2", "N2", "O2"]
      
    bga_2:
      port: "COM3"
      name: "BGA02"
      gas_types: ["O2", "H2", "N2"]
      description: "Gas analyzer on oxygen header"
      # Gas analysis configuration for normal operation
      normal_mode:
        primary_gas: "O2"     # O2 in H2 mixture
        secondary_gas: "H2"   # O2 in H2 mixture
        remaining_gas: "N2"   # Remaining gas (calculated)
        expected_gases: ["O2", "H2", "N2"]
      # Gas analysis configuration for purge operation
      purge_mode:
        primary_gas: "O2"     # O2 in N2 during purge
        secondary_gas: "N2"   # N2 purge gas
        remaining_gas: "H2"   # Remaining gas (calculated)
        expected_gases: ["O2", "N2", "H2"]
      
    bga_3:
      port: "COM9"
      name: "BGA03"
      gas_types: ["H2", "O2", "N2"]
      description: "Gas analyzer on de-oxo unit"
      # Gas analysis configuration for normal operation
      normal_mode:
        primary_gas: "O2"     # H2 in O2 mixture
        secondary_gas: "H2"   # H2 in O2 mixture
        remaining_gas: "N2"   # Remaining gas (calculated)
        expected_gases: ["O2", "H2", "N2"]
      # Gas analysis configuration for purge operation
      purge_mode:
        primary_gas: "O2"     # H2 in N2 during purge
        secondary_gas: "N2"   # N2 purge gas
        remaining_gas: "H2"   # Remaining gas (calculated)
        expected_gases: ["O2", "N2", "H2"]

# CVM-24P Cell Voltage Monitor
cvm24p:
  device_type: "CVM-24P"
  connection: "USB"
  protocol: "XC2"
  
  # Physical Module Mapping
  modules:
    # Module 1: Physical position 1
    '158458':
      address: 0xA1
      name: "Module 1"
      channels: [1, 24]  # Channels 1-24
      description: "CVM24P Module 1 - First physical module"
    
    # Module 2: Physical position 2  
    '158436':
      address: 0xA6
      name: "Module 2"
      channels: [25, 48]  # Channels 25-48
      description: "CVM24P Module 2 - Second physical module"
    
    # Module 3: Physical position 3
    '158435':
      address: 0xA7
      name: "Module 3"
      channels: [49, 72]  # Channels 49-72
      description: "CVM24P Module 3 - Third physical module"
    
    # Module 4: Physical position 4
    '158453':
      address: 0xA4
      name: "Module 4"
      channels: [73, 96]  # Channels 73-96
      description: "CVM24P Module 4 - Fourth physical module"
    
    # Module 5: Physical position 5
    '158340':
      address: 0xA9
      name: "Module 5"
      channels: [97, 120]  # Channels 97-120
      description: "CVM24P Module 5 - Fifth physical module"
  
  # Cell Voltage Configuration
  cells:
    total_cells: 120
    groups: 6  # Group into 6 groups of 20 cells each
    voltage_range: [0, 5]  # Volts
      
  communication:
    baud_rate: 1000000  # 1MHz - XC2 protocol standard
    data_bits: 8
    stop_bits: 1
    parity: "None"
    timeout: 1.0

# System-Wide Configuration
system:
  # Data Acquisition Rates
  sample_rates:
    ni_daq: 100      # Hz - NI cDAQ analog inputs
    pico_tc08: 1     # Hz - Temperature readings
    bga244: 0.2      # Hz - Gas analyzer readings (every 5 seconds)
    cvm24p: 10       # Hz - Cell voltage readings
  
  # Calibration Settings
  calibration:
    auto_zero_on_startup: true  # Automatically apply zero offsets on connection
    allow_runtime_adjustment: false  # Prevent accidental calibration changes during tests
    calibration_date: "2025-06-04"   # Updated calibration date
    calibration_technician: "Engineering Team"
    
    # Zero Offset Application Rules
    zero_offset_rules:
      temperature_sensors: "Apply at ambient conditions (20-25¬∞C)"
      pressure_sensors: "Apply at atmospheric pressure (0 psig) with sensors vented to atmosphere"
      current_sensor: "Apply with no load current (0 A)"
      gas_analyzers: "Apply in nitrogen purge environment"
      voltage_sensors: "Apply with stack at rest potential"
    
    # Calibration Notes (2025-06-04)
    calibration_notes:
      current_range_update: "Changed minimum current from 3.95mA to 4.0mA for standard 4-20mA scaling"
      pressure_sensor_1: "Zero offset -0.035 PSI applied to correct +0.035 PSI bias at 0 PSI"
      pressure_sensor_2: "Zero offset -0.066 PSI applied to correct +0.066 PSI bias at 0 PSI"
      calibration_method: "Sensors vented to atmosphere (0 psig) for zero point calibration"

 