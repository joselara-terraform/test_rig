# devices.yaml
# AWE Test Rig Hardware Configuration
# 
# This file contains all hardware-specific settings including:
# - NI cDAQ channel mappings and calibration
# - Serial port configurations  
# - Device communication settings
# - CALIBRATED ZERO OFFSETS for pressure/current sensors

# âœ… NI-DAQmx library available
# âœ… Pico TC-08 libraries available
# âœ… Window icon loaded: C:\Users\terra\Desktop\test_rig\assets\favicon.ico
# âœ… Dashboard window maximized
# ğŸ“ Initializing session directories:
#    â†’ Base data directory: C:\Users\terra\Desktop\test_rig\data
#    â†’ Sessions directory: C:\Users\terra\Desktop\test_rig\data\sessions
#    â†’ âœ… Directory structure ready
# ğŸ” Loading configuration from: C:\Users\terra\Desktop\test_rig\config\devices.yaml
# âœ… Device configuration loaded from C:\Users\terra\Desktop\test_rig\config\devices.yaml
#    Calibration date: 2025-06-04
#    ğŸ” Loaded BGA units: ['bga_1', 'bga_2', 'bga_3']
#      bga_1 (COM8): H2/O2
#      bga_2 (COM3): O2/H2
#      bga_3 (COM9): O2/H2
# ğŸ”Œ Connect button clicked
# ğŸ”Œ Starting all hardware services...
#    â†’ Starting NI cDAQ service...
# ğŸ”Œ Connecting to NI cDAQ...
#    â†’ Connecting to NI-DAQmx hardware
#    â†’ Scanning for cDAQ devices...
#      â€¢ Found: cDAQ9187-23E902C (cDAQ-9187)
#    â†’ Configuring analog input channels:
#      â€¢ PT01: cDAQ9187-23E902CMod1/ai0 (4-20mA, calibrated 4.0-20.0mA)
#      â€¢ PT02: cDAQ9187-23E902CMod1/ai1 (4-20mA, calibrated 4.0-20.0mA)
#      â€¢ Current: cDAQ9187-23E902CMod1/ai2 (4-20mA, calibrated 4.0-20.0mA)
#      â€¢ PT03: cDAQ9187-23E902CMod1/ai3 (4-20mA, calibrated 4.0-20.0mA)
#      â€¢ PT04: cDAQ9187-23E902CMod1/ai4 (4-20mA, calibrated 4.0-20.0mA)
#      â€¢ PT05: cDAQ9187-23E902CMod1/ai5 (4-20mA, calibrated 4.0-20.0mA)
#      â€¢ Flowrate: cDAQ9187-23E902CMod1/ai6 (4-20mA, calibrated 4.0-20.0mA)
#      â€¢ PT06: cDAQ9187-23E902CMod1/ai7 (4-20mA, calibrated 4.0-20.0mA)
#    â†’ Configuring digital output channels:
#      â€¢ KOH Storage: cDAQ9187-23E902CMod2/port0/line0
#      â€¢ DI Storage: cDAQ9187-23E902CMod2/port0/line1
#      â€¢ Stack Drain: cDAQ9187-23E902CMod2/port0/line2
#      â€¢ N2 Purge: cDAQ9187-23E902CMod2/port0/line3
#      â€¢ O2 Purge: cDAQ9187-23E902CMod2/port0/line5
#      â€¢ Pump: cDAQ9187-23E902CMod2/port0/line4
#      â€¢ KOH Pump: cDAQ9187-23E902CMod2/port0/line6
#    â†’ Setting all outputs to safe state (OFF)
# âœ… Real NI cDAQ connected successfully
# ğŸ“Š Starting NI DAQ polling at 100 Hz...
# âœ… NI DAQ polling started
#    âœ… NI cDAQ connected - Pressure/Current sensors + Valve/Pump control
#    â†’ Starting Pico TC-08 service...
# ğŸŒ¡ï¸  Connecting to Pico TC-08 thermocouple logger...
#    â†’ Loading TC-08 DLL...
#    â†’ TC-08 library loaded: C:\Program Files\Pico Technology\SDK\lib\usbtc08.dll
#    â†’ DLL loaded successfully
#    â†’ Connecting to hardware...
#    â†’ TC-08 device opened with handle: 1
#    â†’ Hardware connected (handle: 1)
#    â†’ Configuring channels...
#    â†’ Configured 8 K-type thermocouple channels
#    â†’ Configured 8 thermocouple channels:
#      â€¢ CH0: TC01
#      â€¢ CH1: TC02
#      â€¢ CH2: TC03
#      â€¢ CH3: TC04
#      â€¢ CH4: TC05
#      â€¢ CH5: TC06
#      â€¢ CH6: TC07
#      â€¢ CH7: TC08
# âœ… Pico TC-08 connected successfully
# ğŸŒ¡ï¸  Starting Pico TC-08 polling at 1 Hz...
#    â†’ TC-08 streaming started at 1Hz
# âœ… Pico TC-08 polling started
#    âœ… Pico TC-08 connected - 8-channel thermocouple logger
#    â†’ Starting BGA244 analyzers...
# âš—ï¸  Connecting to BGA244 gas analyzers...
#    â†’ Attempting hardware connection...
#    â†’ Connecting BGAs to configured ports...
#    â†’ Trying to connect BGA01 to COM8...
# ğŸ”Œ Connecting to BGA01 on COM8...
# âŒ No response from device on COM8
# âœ… Disconnected from COM8
#    âŒ BGA01 failed to connect to COM8
#    â†’ Trying to connect BGA02 to COM3...
# ğŸ”Œ Connecting to BGA02 on COM3...
# âŒ No response from device on COM3
# âœ… Disconnected from COM3
#    âŒ BGA02 failed to connect to COM3
#    â†’ Trying to connect BGA03 to COM9...
# ğŸ”Œ Connecting to BGA03 on COM9...
# âŒ Connection failed on COM9: could not open port 'COM9': FileNotFoundError(2, 'The system cannot find the file specified.', None, 2)
#    âŒ BGA03 failed to connect to COM9
# âš ï¸  No BGA244 hardware detected
#    â†’ All BGAs will show no data until connected
# âœ… BGA244 service ready (0 devices connected)
# âš—ï¸  Starting BGA244 polling at 0.2 Hz...
# âœ… BGA244 polling started
#    âœ… BGA244 connected - 3x gas analyzers (H2, O2, N2)
#    â†’ Starting CVM-24P service...
#    â†’ Loaded 5 module mappings from devices.yaml
#    â†’ Physical connection order:
#       Module 1 - 158458 (0xA1)
#       Module 2 - 158436 (0xA6)
#       Module 3 - 158435 (0xA7)
#       Module 4 - 158453 (0xA4)
#       Module 5 - 158340 (0xA9)
# ğŸ”‹ Connecting to CVM-24P cell voltage monitor...
#    â†’ Attempting hardware connection...
#    â†’ Found 1 available ports: ['COM5']
#    â†’ Trying port COM5 (1/1)...
# DEBUG: ===== Starting CVM24P connection debug session =====
#    â†’ Connecting to COM5 at 1000000 baud...
#       â†’ Bus connected
#       â†’ Using ultra-fast initialization with cached addresses...
#       â†’ âœ… Created module map for 5 cached modules - proceeding to initialization
#    â†’ Initializing 5 modules...
#    â†’ DEBUG: Initialization order: ['158458', '158436', '158435', '158453', '158340']
#    âœ… Module 158458 (0xA1) initialized
#    âœ… Module 158436 (0xA6) initialized
#    âœ… Module 158435 (0xA7) initialized
#    âœ… Module 158453 (0xA4) initialized
#    âœ… Module 158340 (0xA9) initialized
#    â†’ DEBUG: Successfully initialized modules: ['158458', '158436', '158435', '158453', '158340']
#    â†’ Success! 5/5 modules initialized via ultra-fast cached path (100.0% success rate)
# DEBUG: Voltage reading - module sorting and channel assignment (PHYSICAL ORDER):
#    â†’ Success on COM5!
# DEBUG:   Module 158458 (0xA1) â†’ Channels 1-24
# DEBUG:   Module 158436 (0xA6) â†’ Channels 25-48
# DEBUG:   Module 158435 (0xA7) â†’ Channels 49-72
# DEBUG:   Module 158453 (0xA4) â†’ Channels 73-96
# DEBUG:   Module 158340 (0xA9) â†’ Channels 97-120
# âœ… CVM-24P connected - Hardware mode with 5 modules
# ğŸ”‹ Starting CVM-24P polling at 10 Hz...
# âœ… CVM-24P polling started
#    âœ… CVM-24P connected - 24-channel cell voltage monitor
# âœ… All 4/4 services started successfully
#    âœ… All devices connected via ControllerManager
# Visible voltage channels: [0]
# Visible voltage channels: [0, 24]
# Visible voltage channels: [0, 24, 48]
# Visible voltage channels: [0, 24, 48, 72]
# Visible voltage channels: [0, 24, 48, 72, 96]
# Visible pressure channels: [0, 1, 2, 3, 4, 5]
# â–¶ï¸  Start Test button clicked
#    â†’ Starting test sequence...
#    â†’ Plots reset for new test
# ğŸ§ª Starting new test session...
# ğŸ“ New test session started: 2025-07-31_17-00-42_UI_Test_Session
#    â†’ Session path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session
#    â†’ Start time: 2025-07-31 17:00:42
#    â†’ Timer started from 0
#    â†’ Configuration snapshot saved
#    â†’ Starting CSV data logging...
# ğŸ“Š Starting CSV data logging...
#    â†’ Session: 2025-07-31_17-00-42_UI_Test_Session
#    â†’ Session folder: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session
#    â†’ Absolute path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session
#    â†’ Initializing CSV files...
#       â†’ Getting base filename from session manager...
#       â†’ Base filename: 2025-07-31_17-00-42
#       â†’ Creating 4 CSV files...
#          â€¢ Creating main_sensors: 2025-07-31_17-00-42_sensors.csv
#            â†’ Full path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\csv_data\2025-07-31_17-00-42_sensors.csv
#            â†’ Opening file for writing...
#            â†’ Writing 18 column headers
#            â†’ âœ… main_sensors file created successfully
#          â€¢ Creating gas_analysis: 2025-07-31_17-00-42_gas_analysis.csv
#            â†’ Full path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\csv_data\2025-07-31_17-00-42_gas_analysis.csv
#            â†’ Opening file for writing...
#            â†’ Writing 9 column headers
#            â†’ âœ… gas_analysis file created successfully
#          â€¢ Creating cell_voltages: 2025-07-31_17-00-42_cell_voltages.csv
#            â†’ Full path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\csv_data\2025-07-31_17-00-42_cell_voltages.csv
#            â†’ Opening file for writing...
#            â†’ Writing 122 column headers
#            â†’ âœ… cell_voltages file created successfully
#          â€¢ Creating actuator_states: 2025-07-31_17-00-42_actuators.csv
#            â†’ Full path: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\csv_data\2025-07-31_17-00-42_actuators.csv
#            â†’ Opening file for writing...
#            â†’ Writing 9 column headers
#            â†’ âœ… actuator_states file created successfully
#       â†’ âœ… All 4 CSV files initialized
# ğŸ“Š CSV logging worker started (interval: 1.0s)
# âœ… CSV logging started successfully
#    â†’ Log interval: 1.0s
#    â†’ Files created: 4
#       â€¢ main_sensors: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\csv_data\2025-07-31_17-00-42_sensors.csv
#       â€¢ gas_analysis: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\csv_data\2025-07-31_17-00-42_gas_analysis.csv
#       â€¢ cell_voltages: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\csv_data\2025-07-31_17-00-42_cell_voltages.csv
#       â€¢ actuator_states: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\csv_data\2025-07-31_17-00-42_actuators.csv
# âœ… Test session started: 2025-07-31_17-00-42_UI_Test_Session
#    â†’ Session folder: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session
#    â†’ Configuration saved: 2025-07-31_17-00-42.json
#    â†’ Timer: âœ… Started
#    â†’ CSV logging: âœ… Started - Files will be created
#    â†’ Log files: sensors.csv, gas_analysis.csv, cell_voltages.csv, actuators.csv
#    âœ… Test started successfully with CSV data logging
#    â†’ CSV files are being created in session folder
# â¹ï¸  Stop Test button clicked
#    â†’ Stopping test sequence...
# ğŸ§ª Stopping test session...
#    â†’ Timer stopped and reset
# ğŸ“Š Stopping CSV data logging...
# ğŸ“Š CSV logging worker stopped
# âœ… CSV logging stopped
#    â†’ Log entries: 300
#    â†’ Duration: 05:01
# ğŸ“ Active channels saved to session metadata:
#    â†’ pressure: [0, 1, 2, 3, 4, 5]
#    â†’ gas: [0, 1, 2]
#    â†’ temperature: [0, 1, 2, 3, 4, 5, 6, 7]
#    â†’ voltage: [0, 24, 48, 72, 96]
#    â†’ current: [0]
# ğŸ“ Session ended: 2025-07-31_17-00-42_UI_Test_Session
#    â†’ Duration: 0:05:02
#    â†’ Status: completed
#    â†’ Files created: 5
#    â†’ Starting post-processing...
# ğŸ”„ Starting post-processing for session: 2025-07-31_17-00-42_UI_Test_Session
# ğŸ“Š Loading CSV data from C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\csv_data
#    â†’ Loading sensors: 2025-07-31_17-00-42_sensors.csv
#    âœ… Loaded 300 rows from sensors
#    â†’ Loading gas_analysis: 2025-07-31_17-00-42_gas_analysis.csv
#    âœ… Loaded 300 rows from gas_analysis
#    â†’ Loading cell_voltages: 2025-07-31_17-00-42_cell_voltages.csv
#    âœ… Loaded 300 rows from cell_voltages
#    â†’ Loading actuators: 2025-07-31_17-00-42_actuators.csv
#    âœ… Loaded 300 rows from actuators
# âœ… Data loaded successfully, max time: 301.2s
# ğŸ“Š Generating pressure plot...
# âœ… Pressure plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\plots\pressure.jpg
# ğŸ“Š Generating gas purity plot...
# âœ… Gas purity plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\plots\gas_purity.jpg
# ğŸ“Š Generating temperature plot...
# âœ… Temperature plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\plots\temperature.jpg
# ğŸ“Š Generating cell voltage plot...
# âœ… Cell voltage plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\plots\cell_voltage.jpg
# ğŸ“Š Generating current plot...
# âœ… Current plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\plots\current.jpg
# ğŸ“Š Generating flowrate plot...
# âœ… Flowrate plot saved: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\plots\flowrate.jpg
# âœ… Post-processing complete: 6/6 plots generated
#    â†’ Plots saved to: C:\Users\terra\Desktop\test_rig\data\sessions\2025-07-31_17-00-42_UI_Test_Session\plots
#    âœ… Post-processing completed - plots generated
# âœ… Test session stopped
#    â†’ Final status: completed
#    â†’ Duration: 0:05:02
#    â†’ Files created: 5
#    â†’ Data logged: 300 entries
#    âœ… Test stopped - CSV data logging completed
#    â†’ 5 files saved in session folder

# NI cDAQ Configuration
ni_cdaq:
  chassis: "cDAQ9187-23E902C"
  
  # NI-9253 Analog Input Module (4-20mA Current Inputs)
  analog_inputs:
    module: "cDAQ9187-23E902CMod1"
    sample_rate: 100  # Hz
    
    # 4-20mA Signal Conditioning
    current_range:
      min_ma: 4.0   # Calibrated minimum - 4mA = 0 PSI/A (updated from 3.95)
      max_ma: 20.0  # Standard maximum
      fault_threshold_low: 3.5   # Below this = DISCONNECTED
      fault_threshold_high: 20.5 # Above this = OVERRANGE
    
    # Individual Sensor Channels with Calibrated Zero Offsets
    channels:
      pt01:
        channel: "ai0"
        name: "PT01"
        units: "PSI"
        range: [0, 15]
        # CALIBRATED ZERO OFFSET - Corrects sensor bias at 0 PSI
        zero_offset: -0.035  # Corrects +0.035 PSI bias to achieve true 0 PSI
        description: "Hydrogen side pressure measurement"
        
      pt02:
        channel: "ai1" 
        name: "PT02"
        units: "PSI"
        range: [0, 15]
        # CALIBRATED ZERO OFFSET - Corrects sensor bias at 0 PSI  
        zero_offset: -0.066  # Corrects +0.066 PSI bias to achieve true 0 PSI
        description: "Oxygen side pressure measurement"
        
      current:
        channel: "ai2"
        name: "Current"
        units: "A"
        range: [0, 150]
        # CALIBRATED ZERO OFFSET - 4mA represents true 0 A
        zero_offset: 0.0  # No bias correction needed for current sensor
        description: "Electrolyzer stack current measurement"
        
      pt03:
        channel: "ai3"
        name: "PT03"
        units: "PSI"
        range: [0, 1.012]  # 0-28 inWC converted to PSI (28 * 0.036127 = 1.012)
        zero_offset: 0.0
        description: "Pressure transducer 01 (4-20mA)"
        
      pt04:
        channel: "ai4"
        name: "PT04"  
        units: "PSI"
        range: [0, 1.012]  # 0-28 inWC converted to PSI
        zero_offset: 0.0
        description: "Pressure transducer 02 (4-20mA)"
        
      pt05:
        channel: "ai5"
        name: "PT05"
        units: "PSI"
        range: [0, 1.012]  # 0-28 inWC converted to PSI
        zero_offset: 0.0
        description: "Pressure transducer 03 (4-20mA)"
        
      flowrate:
        channel: "ai6"
        name: "Flowrate"
        units: "SLM"
        range: [0, 250]  # 0-250 SLM (Standard Liters per Minute)
        zero_offset: 0.0
        description: "Gas flowrate measurement"
        
      pt06:
        channel: "ai7"
        name: "PT06"
        units: "PSI"
        range: [0, 1.012]  # 0-28 inWC converted to PSI
        zero_offset: 0.0
        description: "Pressure transducer 05 (4-20mA)"
  
  # NI-9485 Digital Output Modules (Relay Control)
  digital_outputs:
    module_2: "cDAQ9187-23E902CMod2"
    module_3: "cDAQ9187-23E902CMod3"
    
    # Valve and Pump Control Mapping
    valves:
      koh_storage:
        module: "cDAQ9187-23E902CMod2"
        line: 0
        name: "KOH Storage Valve"
        description: "Controls KOH electrolyte storage tank valve"
        
      di_storage:
        module: "cDAQ9187-23E902CMod2"
        line: 1
        name: "DI Storage Valve"
        description: "Controls deionized water storage tank valve"
        
      stack_drain:
        module: "cDAQ9187-23E902CMod2" 
        line: 2
        name: "Stack Drain Valve"
        description: "Controls electrolyzer stack drain valve"
        
      h2_purge:
        module: "cDAQ9187-23E902CMod2"
        line: 3
        name: "H2 Purge Valve"
        description: "Controls hydrogen purge valve for system cleanup"
        
      o2_purge:
        module: "cDAQ9187-23E902CMod2"
        line: 5
        name: "O2 Purge Valve"
        description: "Controls oxygen purge valve for system cleanup"
        
    pump:
      di_fill_pump:
        module: "cDAQ9187-23E902CMod2"
        line: 4
        name: "DI Fill Pump"
        description: "Controls deionized water fill pump"
        
      koh_fill_pump:
        module: "cDAQ9187-23E902CMod2"
        line: 6
        name: "KOH Fill Pump"
        description: "Controls KOH electrolyte fill pump"

# Pico TC-08 Thermocouple Logger
pico_tc08:
  device_type: "Pico TC-08"
  connection: "USB"
  
  # Temperature Channels - NO ZERO OFFSETS (raw thermocouple readings)
  channels:
    channel_0:
      name: "TC01"
      type: "K"  # Thermocouple type
      units: "Â°C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 1 temperature sensor"
      
    channel_1:
      name: "TC02"
      type: "K"
      units: "Â°C" 
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 2 temperature sensor"
      
    channel_2:
      name: "TC03"
      type: "K"
      units: "Â°C"
      range: [0, 100] 
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 3 temperature sensor"
      
    channel_3:
      name: "TC04"
      type: "K"
      units: "Â°C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 4 temperature sensor"
      
    channel_4:
      name: "TC05"
      type: "K"
      units: "Â°C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 5 temperature sensor"
      
    channel_5:
      name: "TC06"
      type: "K"
      units: "Â°C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 6 temperature sensor"
      
    channel_6:
      name: "TC07"
      type: "K"
      units: "Â°C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 7 temperature sensor"
      
    channel_7:
      name: "TC08"
      type: "K"
      units: "Â°C"
      range: [0, 100]
      # NO ZERO OFFSET - Temperature sensors read direct thermocouple values
      description: "Thermocouple 8 temperature sensor"

# BGA244 Gas Analyzers (3 units)
bga244:
  communication:
    protocol: "RS-422"
    interface: "USB-to-RS422"
    baud_rate: 9600
    data_bits: 8
    stop_bits: 1
    parity: "None"
    timeout: 2.0  # seconds
  
  # Three BGA244 Units (Windows COM ports)
  units:
    bga_1:
      port: "COM8"
      name: "BGA01"
      gas_types: ["H2", "O2", "N2"]
      description: "Gas analyzer on hydrogen header"
      # Gas analysis configuration for normal operation
      normal_mode:
        primary_gas: "H2"     # H2 in O2 mixture
        secondary_gas: "O2"   # H2 in O2 mixture
        remaining_gas: "N2"   # Remaining gas (calculated)
        expected_gases: ["H2", "O2", "N2"]
      # Gas analysis configuration for purge operation
      purge_mode:
        primary_gas: "H2"     # H2 in N2 during purge
        secondary_gas: "N2"   # N2 purge gas
        remaining_gas: "O2"   # Remaining gas (calculated)
        expected_gases: ["H2", "N2", "O2"]
      
    bga_2:
      port: "COM3"
      name: "BGA02"
      gas_types: ["O2", "H2", "N2"]
      description: "Gas analyzer on oxygen header"
      # Gas analysis configuration for normal operation
      normal_mode:
        primary_gas: "O2"     # O2 in H2 mixture
        secondary_gas: "H2"   # O2 in H2 mixture
        remaining_gas: "N2"   # Remaining gas (calculated)
        expected_gases: ["O2", "H2", "N2"]
      # Gas analysis configuration for purge operation
      purge_mode:
        primary_gas: "O2"     # O2 in N2 during purge
        secondary_gas: "N2"   # N2 purge gas
        remaining_gas: "H2"   # Remaining gas (calculated)
        expected_gases: ["O2", "N2", "H2"]
      
    bga_3:
      port: "COM9"
      name: "BGA03"
      gas_types: ["H2", "O2", "N2"]
      description: "Gas analyzer on de-oxo unit"
      # Gas analysis configuration for normal operation
      normal_mode:
        primary_gas: "O2"     # H2 in O2 mixture
        secondary_gas: "H2"   # H2 in O2 mixture
        remaining_gas: "N2"   # Remaining gas (calculated)
        expected_gases: ["O2", "H2", "N2"]
      # Gas analysis configuration for purge operation
      purge_mode:
        primary_gas: "O2"     # H2 in N2 during purge
        secondary_gas: "N2"   # N2 purge gas
        remaining_gas: "H2"   # Remaining gas (calculated)
        expected_gases: ["O2", "N2", "H2"]

# CVM-24P Cell Voltage Monitor
cvm24p:
  device_type: "CVM-24P"
  connection: "USB"
  protocol: "XC2"
  
  # Physical Module Mapping
  modules:
    # Module 1: Physical position 1
    '158458':
      address: 0xA1
      name: "Module 1"
      channels: [1, 24]  # Channels 1-24
      description: "CVM24P Module 1 - First physical module"
    
    # Module 2: Physical position 2  
    '158436':
      address: 0xA6
      name: "Module 2"
      channels: [25, 48]  # Channels 25-48
      description: "CVM24P Module 2 - Second physical module"
    
    # Module 3: Physical position 3
    '158435':
      address: 0xA7
      name: "Module 3"
      channels: [49, 72]  # Channels 49-72
      description: "CVM24P Module 3 - Third physical module"
    
    # Module 4: Physical position 4
    '158453':
      address: 0xA4
      name: "Module 4"
      channels: [73, 96]  # Channels 73-96
      description: "CVM24P Module 4 - Fourth physical module"
    
    # Module 5: Physical position 5
    '158340':
      address: 0xA9
      name: "Module 5"
      channels: [97, 120]  # Channels 97-120
      description: "CVM24P Module 5 - Fifth physical module"
  
  # Cell Voltage Configuration
  cells:
    total_cells: 120
    groups: 6  # Group into 6 groups of 20 cells each
    voltage_range: [0, 5]  # Volts
      
  communication:
    baud_rate: 1000000  # 1MHz - XC2 protocol standard
    data_bits: 8
    stop_bits: 1
    parity: "None"
    timeout: 1.0

# System-Wide Configuration
system:
  # Data Acquisition Rates
  sample_rates:
    ni_daq: 100      # Hz - NI cDAQ analog inputs
    pico_tc08: 1     # Hz - Temperature readings
    bga244: 0.2      # Hz - Gas analyzer readings (every 5 seconds)
    cvm24p: 10       # Hz - Cell voltage readings
  
  # Calibration Settings
  calibration:
    auto_zero_on_startup: true  # Automatically apply zero offsets on connection
    allow_runtime_adjustment: false  # Prevent accidental calibration changes during tests
    calibration_date: "2025-06-04"   # Updated calibration date
    calibration_technician: "Engineering Team"
    
    # Zero Offset Application Rules
    zero_offset_rules:
      temperature_sensors: "Apply at ambient conditions (20-25Â°C)"
      pressure_sensors: "Apply at atmospheric pressure (0 psig) with sensors vented to atmosphere"
      current_sensor: "Apply with no load current (0 A)"
      gas_analyzers: "Apply in nitrogen purge environment"
      voltage_sensors: "Apply with stack at rest potential"
    
    # Calibration Notes (2025-06-04)
    calibration_notes:
      current_range_update: "Changed minimum current from 3.95mA to 4.0mA for standard 4-20mA scaling"
      pressure_sensor_1: "Zero offset -0.035 PSI applied to correct +0.035 PSI bias at 0 PSI"
      pressure_sensor_2: "Zero offset -0.066 PSI applied to correct +0.066 PSI bias at 0 PSI"
      calibration_method: "Sensors vented to atmosphere (0 psig) for zero point calibration"

 